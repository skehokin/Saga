<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300" rel="stylesheet"> 
  <link href="static/sagastyle.css" rel="stylesheet">
   <link href="static/{{userbuttons}}.css" rel="stylesheet">
  <script type="text/javascript" src="static/saga.js"></script>

   
  <title>{{blogname}} on saga</title>
  <style>
    .blogHero {
    	background-image: url(static/{{image}});

    }
    
  </style>


</head>
  <body class="blogbody">
	<header class="header"> <img src = "/static/sagaLogo.svg" class = "smallLogo"> <span class="toprightlinks"> <a href="/logout" class="logout">log out</a> <a href="/login" class="login">log in</a></span>
	</header>
	<main>
	<header class="blogHero">
		<!-- <img src="/static/bloghero_tower.jpg" class="blogHeroImage"> -->
		<h1 class="blogname">{{blogname}}
		</h1>
		<section class="buttonwrap"><a href="/newpost"><section class="loginSubmit newpost"> NEW POST</section></a></section>

	</header>

	<nav class="blognavwrap"> 
	<h3 class="blognav">about</h3> <h3 class="blognav">archive</h3>
	</nav>
	<div class="clear"></div>

	{% for element in blogposts%}

	<article class="wholepost">
		<article class="blogpost">
			<header class="blogheader"><h2 class="blogtitle">{{element.subject}}</h2>
				<h3>by {{element.author}}  -  {{element.created.strftime("%H:%M %A %d %B %Y") }}. 
				<br>{{element.likeslength}} people like this post.</h3>
			</header>

			<section class="postcontent">

				{{element.content |safe}}

			</section>

			{%if element.created.strftime("%H:%M %A %d %B %Y")!=element.last_edited.strftime("%H:%M %A %d %B %Y")%}
			<h4 class="posteditnote">last edited {{element.last_edited.strftime("%H:%M %A %d %B %Y")}}</h4>
			{%endif%}

		</article>

		<footer class="blogpostoptions">
			<div class="optionswrapper">
				<a href="/_like/{{element.identity}}"><h3 class="option like"> <span class="entypo-heart"></span></h3></a>
				<a href="/_delete/{{element.identity}}"><h3 class="option delete"> <span class="entypo-cup"></span></h3></a>
				<a href="/_edit/{{element.identity}}"><h3 class="option edit"> <span class="entypo-pencil"></span></h3></a>
				<h3 class="option commentbutton" id="button{{loop.index}}"> <span class="entypo-chat"></span></h3>
				<a href="/{{element.identity}}"><h3 class="option permalink"> <span class="entypo-infinity"></span></h3></a>
			</div>
		</footer>

		<section class="commentwrap" id="comment{{loop.index}}">

			<h3>comments on {{element.subject}}</h3>

	{% for each in comments if each.postidentity==element.identity%}
			
			<article class="singlecomment">
				<section class="commentcontent">
	 				{{each.content}}
	 			</section>
      			<footer>
       				 <p>
          				Posted at
          				<time >{{each.created.strftime("%H:%M on %A %d %B %Y")}}</time>
         				by <a href="/{{each.author}}">{{each.author}}.</a>
        			</p>

     			 </footer>

			</article>

	{% else %}
				<article class="singlecomment">
				<section class="commentcontent">
				This post has no comments yet.
				</section>
				</article>

	{%endfor%}

	<form method="post">
	<label><p> make a comment</p>
	<p>
	<textarea name="content" class="commentBox"></textarea>
	</p>
	</label>
	<input type="hidden" name="post_id" value="{{element.identity}}">
	<input type="submit" name="commentsubmit" class="loginSubmit newcomment" value="add comment">
	</form>


      <footer><p id="remove{{loop.index}}">click to hide comments</p>
      </footer>
	</section>

	</article>

	{%else%}

	<article class="wholepost">
		<article class="blogpost">
			<header class="blogheader"><h2 class="blogtitle">No Posts Yet!</h2>
				<h3>by saga</h3>
			</header>

			<section class="postcontent">

				It looks like {{username}} hasn't made any posts yet.

			</section>



		</article>


	</article>


	{%endfor%}

	</main>

	<script>


	{% for element in blogposts%}
	document.getElementById('button{{loop.index}}').onclick = function() {
	document.getElementById('comment{{loop.index}}').style.display="block";
	}
	document.getElementById('remove{{loop.index}}').onclick = function() {
	document.getElementById('comment{{loop.index}}').style.display="none";
	}

	{%endfor%}


// 		document.getElementById('comment'+String(i)).style.display="none";

// }

	</script>
   
  </body>
</html>
